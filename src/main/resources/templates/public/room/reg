<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head th:replace="layout/public::header"></head>
<body class="page-body skin-red">
<div class="page-container      ">
    <div th:replace="layout/public::leftbar"></div>
    <div class="main-content" style="min-height: 828px;">

        <div th:replace="layout/public::headerBar"></div>
        <div class="right_col" role="main" th:fragment="reg_room">
            <div class="right_col" role="main">
                <div class="">
                    <div class="page-title">
                        <div class="title_left">
                            <h3>Danh sách phòng</h3>
                        </div>
                        <div class="title_right">
                            <div class="col-md-5 col-sm-5 col-xs-12 form-group pull-right top_search">
                                <div class="input-group">
                                    <input type="text" class="form-control" placeholder="Search for...">
                                    <span class="input-group-btn">
                              <button class="btn btn-default" type="button">Go!</button>
                              </span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="clearfix"></div>
                    <div class="row">
                        <div class="col-md-12 col-sm-12 col-xs-12">
                            <div class="x_panel">
                                <div class="x_title">
                                    <th:block th:if="${msg != null}" th:with="type=${msg.type == 1 ? 'success' : 'danger'}">
                                        <div th:class="${'alert alert-' + type}" style="margin-left: 200px">
                                            <strong th:text="${msg.message}"></strong>
                                        </div>
                                    </th:block>
                                    <div class="clearfix"></div>
                                </div>
                                <div class="x_content">
                                    <form data-parsley-validate class="form-horizontal form-label-left">
                                        <div class="form-group">
                                            <label class="control-label col-md-2 col-sm-2 col-xs-12">Khu nhà
                                            </label>
                                            <div class="col-md-3 col-sm-3 col-xs-12">
                                                <select class="form-control" id="select-area">
                                                    <option th:each="area,iterStat:${areas}" th:text="${area.name}"
                                                            th:value="${area.id}"></option>
                                                </select>
                                            </div>
                                            <label class="control-label col-md-2 col-sm-2 col-xs-12">Tầng
                                            </label>
                                            <div class="col-md-3 col-sm-3 col-xs-12">
                                                <select class="form-control" id="select-floor">
                                                    <option value="0">Tất cả</option>
                                                    <option th:each="floor,iterStat:${floors}" th:value="${floor.id}"
                                                            th:text="${floor.name}">Chọn</option>
                                                </select>
                                            </div>
                                        </div>
                                    </form>
                                    <table class="table table-striped table-hover">
                                        <thead>
                                        <tr>
                                            <th>STT</th>
                                            <th>Phòng</th>
                                            <th>Khu nhà</th>
                                            <th>Số giường tối đa</th>
                                            <th>Số giường trống</th>
                                            <th>Chọn số lượng đăng ký</th>
                                            <th>Giá phòng/giường</th>
                                            <th>Trạng thái</th>
                                            <th width="22%">Hành động</th>
                                        </tr>
                                        </thead>
                                        <tbody id="table-body">
                                        <th:block th:if="${#lists.isEmpty(rooms)}">
                                            <tr><td colspan="8" class="text-center"><h3>Không có dữ liệu!</h3></td></tr>
                                        </th:block>
                                        <th:block th:unless="${#lists.isEmpty(rooms)}">
                                            <tr th:each="room,iterStat:${rooms}">
                                                <th scope="row" th:text="${iterStat.count}">1</th>
                                                <td th:text="${room.name}" class="name"></td>
                                                <td th:text="${room.areaName}" class="area"></td>
                                                <td th:text="${room.numberBed}" class="max"></td>
                                                <th:block th:with="numberBedEmpty = ${room.studentRegister} == null ? ${room.numberBed} : (${room.numberBed} - ${room.studentRegister})">
                                                    <td th:text="${numberBedEmpty}" class="present"></td>
                                                    <th:block th:if="${numberBedEmpty} > 0">
                                                        <td>
                                                            <select class="form-control" id="select-floor">
                                                                <option th:each="numberReg,iterStat:${numberBedEmpty}" th:value="${iterStat.count}"
                                                                        th:text="${iterStat.count}">Chọn</option>
                                                            </select>
                                                        </td>
                                                    </th:block>
                                                    <th:block th:if="${numberBedEmpty} <= 0">
                                                        <td>Hết giường trống!</td>
                                                    </th:block>
                                                </th:block>
                                                <td th:text="${#numbers.formatDecimal(room.costValue, 0, 'COMMA', 0, 'POINT')} + ' VND'" class="cost"></td>
                                                <td th:class="${'stt change-stt-' + room.id}">
                                                    <span th:text="${room.status}" class="hide"></span>
                                                    <th:block th:if="${room.status == 1}">
                                                        <button type="button" class="btn btn-success btn-xs">Chấp nhận
                                                        </button>
                                                    </th:block>
                                                    <th:block th:if="${room.status == 0}">
                                                        <button type="button" class="btn btn-warning btn-xs">Đang chờ
                                                        </button>
                                                    </th:block>
                                                </td>
                                                <td>
                                                    <button class="btn btn-primary btn-xs btn-view" data-toggle="modal"
                                                            data-target="#roomInfoMd"><i class="fa fa-folder"></i> View
                                                    </button>
                                                    <th:block th:if="${room.status == 0}">
                                                        <button class="btn btn-info btn-xs btn-edit" data-toggle="modal"
                                                                data-target="#modalEdit"><i class="fa fa-pencil fa-fw"></i></i>
                                                            Edit
                                                        </button>
                                                        <button class="btn btn-danger" type="submit" onclick="return confirm('Bạn có chắc chắn muốn hủy đăng ký không?')"><i class="fa fa-trash-o  fa-fw" ></i></button>

                                                    </th:block>
                                                    </td>
                                                <td class="id hide" th:text="${room.id}"></td>
                                                <td class="bed hide" th:text="${room.numberBed}"></td>
                                                <td class="register hide" th:text="${room.studentRegister}"></td>
                                                <td class="cost_bed hide" th:text="${room.costValue}"></td>
                                                <td class="name_floor hide" th:text="${room.floorName}"></td>
                                                <td class="function_name hide" th:text="${room.functionName}"></td>
                                            </tr>
                                        </th:block>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                        <div class="clearfix"></div>
                    </div>
                </div>
            </div>
        </div>

    </div>

    <!-- Footer -->
    <footer th:replace="layout/public::footer"></footer>

</div>
<script src="../../../static/public/js/my-custom/registerRoom.js" th:src="@{/public/js/my-custom/registerRoom.js}"></script>
<div th:replace="layout/public::link"></div>
</body>
</html>
